# -*- coding:utf-8 -*-"""This is to implement the logic with python elasticsearch module andpython elasticsearch dsl module to get the data into local server.If this works fine in local server, then I could install with MML server."""from elasticsearch import Elasticsearch, RequestsHttpConnectionfrom requests_aws4auth import AWS4Authimport boto3from elasticsearch_dsl import Searchhost = 'vpc-aliceportal-30899-stage-dmrjizgjptvhd43yb5wdgpmv5i.us-east-1.es.amazonaws.com'region = 'us-east-1'access_key = 'AKIAJESPISZ2QBVPQFGQ'secret_key = 'vzeDw1EcBO5SmgMY761Vq7LpA/DzW03mad/B50g0'service = 'es'# credentials = boto3.Session(aws_access_key_id=access_key, aws_secret_access_key=secret_key).get_credentials()# awsauth = AWS4Auth(credentials.access_key, credentials.secret_key, region, service)awsauth = AWS4Auth(access_key, secret_key, region, service)es = Elasticsearch(    hosts=[{'host': host, 'port': 443}],    http_auth=awsauth,    use_ssl=True,    verify_certs=True,    connection_class=RequestsHttpConnection)index = 'legal_smart'body = {'query': {'range': {'DocumentEffectiveDate': {'gte': '2019-04-01'}}}}res = es.search(index=index, body=body, size=50000, timeout=120)print('already get %d files', len(res['hits']['hits']))