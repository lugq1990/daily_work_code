# -*- coding:utf-8 -*-"""Created at 5:11 PM 12/19/2019This is an example to use python-kafka module with producer and consumerwith kafka installment in local server.Steps should be taken:1. CMD with zkserver to start zookeeper2. start Kafka server: bin\windows\kafka-server-start.bat config\server.properties3. We could start with producer and consumer with different thread.@author: guangqiang.lu"""from json import loadsfrom kafka import KafkaConsumerfrom kafka.errors import KafkaErrorconsumer = KafkaConsumer('test', bootstrap_servers=['localhost:9092'], auto_offset_reset='earliest',                         enable_auto_commit=True, group_id='my_group', value_deserializer=lambda x: loads(x.decode('utf-8')))def consume_data(consumer):    for message in consumer:        message = message.value        print("Get data:", message)        print("Consumer offset:", message.offset)consume_data(consumer)