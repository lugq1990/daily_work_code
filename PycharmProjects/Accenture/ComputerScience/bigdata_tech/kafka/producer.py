# -*- coding:utf-8 -*-"""Created at 5:11 PM 12/19/2019This is an example to use python-kafka module with producer and consumerwith kafka installment in local server.Steps should be taken:1. CMD with zkserver to start zookeeper2. start Kafka server: bin\windows\kafka-server-start.bat config\server.properties3. We could start with producer and consumer with different thread.@author: guangqiang.lu"""from json import dumpsfrom kafka import KafkaProducerfrom kafka.errors import KafkaErrorproducer = KafkaProducer(bootstrap_servers=['localhost:9092'], value_serializer=lambda x: dumps(x).encode('utf-8'))# we could call with success and faildef on_send_success(record_meta):    print("Topic:", record_meta.topic)    print("offset: ", record_meta.offset)def on_send_fail(excp):    print("Sending data with error: %s" % excp)# start to send data to kafka queue, this is asynchronously...for i in range(10):    data = {'num': i}    record_meta = producer.send('test', value=data).add_callback(on_send_success).add_errback(on_send_fail)    # print("already send offset: ", record_meta.get(timeout=10).offset)